<style>
  @keyframes fade {
  from {
    opacity: 0;
    transform: translateY(8px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.animate-fade {
  animation: fade 0.25s ease-out;
}

</style>

<div class="max-w-7xl mx-auto px-8 pb-12"
     *ngIf="filteredGames$ | async as games; else loading">

  <!-- ================= HEADER ================= -->
  <div class="flex justify-between items-center mb-6">
    <h2 class="text-2xl font-semibold text-gray-900">
      Video Games
    </h2>

    <div class="flex items-center gap-3">
      <!-- SEARCH -->
      <input
        type="text"
        [value]="searchTerm$.value"
        (input)="searchTerm$.next($event.target.value)"
        placeholder="Search by title or platform"
        class="px-4 py-2 w-60 border border-gray-300 rounded-lg
               focus:ring-2 focus:ring-blue-500 outline-none">

      <!-- ADD -->
      <button
        routerLink="/videogames/new"
        class="rounded-full bg-black text-white px-5 py-2.5
               text-sm font-medium hover:bg-gray-800 transition cursor-pointer">
        + Add Game
      </button>

      <!-- VIEW TOGGLE -->
      <button
        (click)="toggleView('table')"
        title="Table Format"
        class="px-3 py-2 rounded-lg border cursor-pointer"
        [class.bg-black]="viewMode === 'table'"
        [class.text-white]="viewMode === 'table'">
        üìã
      </button>

      <button
        (click)="toggleView('card')"
        title="Card Format"
        class="px-3 py-2 rounded-lg border cursor-pointer"
        [class.bg-black]="viewMode === 'card'"
        [class.text-white]="viewMode === 'card'">
        üß©
      </button>
    </div>
  </div>

  <!-- ================= TABLE VIEW ================= -->
  <div *ngIf="viewMode === 'table'"
       class="animate-fade bg-white rounded-2xl shadow-sm
              border border-gray-200 overflow-hidden">

    <table class="w-full text-sm text-gray-700">
      <thead class="bg-gray-50 text-xs uppercase text-gray-500">
        <tr>
          <th class="px-6 py-4">#</th>
          <th class="px-6 py-4 text-left">Title</th>
          <th class="px-6 py-4 text-left">Price</th>
          <th class="px-6 py-4 text-left">Platform</th>
          <th class="px-6 py-4 text-right">Actions</th>
        </tr>
      </thead>

      <tbody class="divide-y divide-gray-100">
        <tr *ngFor="let game of games; let i = index"
            class="hover:bg-gray-50">

          <td class="px-6 py-4 text-gray-400">
            {{ i + 1 }}
          </td>

          <td class="px-6 py-4 font-medium text-gray-900 flex items-center gap-3">
          <img *ngIf="game.imageUrl" [src]="game.imageUrl" class="h-10 w-10 rounded object-cover" />

            {{ game.title }}
          </td>

          <td class="px-6 py-4">
            ‚Ç±{{ game.price | number:'1.2-2' }}
          </td>

          <td class="px-6 py-4">
            {{ game.platform }}
          </td>

          <td class="px-6 py-4 text-right">
            <div class="inline-flex gap-3">
              <button
                (click)="editGame(game.id)"
                title="Edit Game"
                class="text-gray-400 hover:text-black cursor-pointer">
                ‚úèÔ∏è
              </button>

              <button
                (click)="confirmDelete(game.id)"
                title="Delete Game"
                class="text-gray-400 hover:text-red-600 cursor-pointer">
                üóëÔ∏è
              </button>
            </div>
          </td>

        </tr>
      </tbody>
    </table>

    <div *ngIf="!games.length"
         class="py-16 text-center text-gray-500">
      No video games found.
    </div>
  </div>

  <!-- ================= CARD VIEW ================= -->
  <div *ngIf="viewMode === 'card'"
       class="animate-fade grid grid-cols-1 sm:grid-cols-2
              lg:grid-cols-3 gap-6">

    <div *ngFor="let game of games"
         class="bg-white rounded-2xl shadow-md hover:shadow-xl
                transition-all duration-300 overflow-hidden">

      <!-- IMAGE -->
      <div class="h-48 bg-gray-100">
      <img
        *ngIf="game.imageUrl"
        [src]="game.imageUrl"
        class="w-full h-full object-cover rounded" />
      </div>

      <!-- CONTENT -->
      <div class="p-5">
        <h3 class="text-lg font-semibold text-gray-900">
          {{ game.title }}
        </h3>

        <p class="text-sm text-gray-500">
          {{ game.platform }}
        </p>

        <p class="mt-2 font-semibold text-gray-900">
          ‚Ç±{{ game.price | number:'1.2-2' }}
        </p>

        <div class="mt-4 flex justify-between items-center">
          <button
            (click)="editGame(game.id)"
            class="text-sm text-blue-600 hover:underline">
            Edit
          </button>

          <button
            (click)="confirmDelete(game.id)"
            class="text-sm text-red-600 hover:underline">
            Delete
          </button>
        </div>
      </div>
    </div>
  </div>

</div>

    <!-- ================= SUCCESS MODAL ================= -->
    <div *ngIf="showSuccessModal"
        class="fixed inset-0 flex items-center justify-center z-50 transition-all duration-300"
        [class.opacity-0]="isFadingOut"
        [class.pointer-events-none]="isFadingOut">

      <!-- Backdrop -->
      <div class="absolute inset-0 bg-black/40 backdrop-blur-sm transition-opacity duration-300"
          [class.opacity-0]="isFadingOut">
      </div>

      <!-- Modal Box -->
      <div class="relative bg-white/50 backdrop-blur-sm border border-white/40 shadow-xl
                  rounded-2xl p-6 max-w-sm w-full mx-4
                  transform transition-all duration-300 ease-out"
          [class.opacity-0]="isFadingOut"
          [class.scale-90]="isFadingOut"
          [class.scale-100]="!isFadingOut">

        <!-- Close Button -->
        <button (click)="closeSuccessModal()"
          class="absolute top-2 right-2 text-gray-500 hover:text-gray-700 text-xl transition">
          √ó
        </button>

        <div class="text-center">
          <div class="text-green-500 text-5xl mb-4 animate-bounce">
            ‚úì
          </div>

          <h3 class="text-xl font-semibold text-gray-900 mb-2">
            Success!
          </h3>

          <p class="text-gray-700">
            {{ successMessage }}
          </p>
        </div>
      </div>
    </div>


    <!-- ================= DELETE MODAL ================= -->
    <div *ngIf="showDeleteModal"
        class="fixed inset-0 z-50 flex items-center justify-center transition-all duration-300"
        [class.opacity-0]="isDeleteFadingOut"
        [class.pointer-events-none]="isDeleteFadingOut">

      <!-- Backdrop -->
      <div class="absolute inset-0 bg-black/50 backdrop-blur-sm transition-opacity duration-300"
          [class.opacity-0]="isDeleteFadingOut">
      </div>

      <!-- Modal Box -->
      <div class="relative bg-white backdrop-blur border border-white/40 shadow-2xl
                  rounded-2xl p-6 max-w-sm w-full mx-4 transform transition-all duration-300 ease-out"
          [class.scale-90]="isDeleteFadingOut"
          [class.scale-100]="!isDeleteFadingOut">

        <h3 class="text-xl font-semibold text-gray-900 mb-3">
          Confirm Delete
        </h3>
        <p class="text-gray-600 mb-6">
          Are you sure you want to delete this video game? This action cannot be undone.
        </p>

        <div class="flex justify-end gap-3">
          <button
            (click)="cancelDelete()"
            class="px-4 py-2 text-gray-700 border border-gray-300 rounded-lg
                  hover:bg-gray-100 transition active:scale-95">
            Cancel
          </button>

          <button
            (click)="deleteConfirmed()"
            class="px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700
                  shadow-md transition active:scale-95">
            Delete
          </button>
        </div>

      </div>
    </div>


<!-- ================= LOADING ================= -->
<ng-template #loading>
  <div class="flex justify-center py-20 text-gray-500">
    Loading games‚Ä¶
  </div>
</ng-template>
