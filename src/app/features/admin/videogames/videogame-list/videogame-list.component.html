<style>
  @keyframes fade {
    from { opacity: 0; transform: translateY(8px); }
    to { opacity: 1; transform: translateY(0); }
  }

  .animate-fade {
    animation: fade 0.25s ease-out;
  }
</style>

<!-- ================= MAIN WRAPPER ================= -->
<div class="max-w-7xl mx-auto px-8 pb-12"
     *ngIf="filteredGames$ | async as games; else skeletonLoading">

  <!-- ================= HEADER ================= -->
  <div class="flex justify-between items-center mb-6 animate-fade">

    <h2 class="text-2xl font-semibold text-gray-900">
      Video Games
    </h2>

    <div class="flex items-center gap-3">

      <input
        type="text"
        [value]="searchTerm$.value"
        (input)="searchTerm$.next($event.target.value)"
        placeholder="Search by title or platform"
        class="px-4 py-2 w-60 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none">

      <button
        routerLink="/videogames/new"
        class="rounded-full bg-black text-white px-5 py-2.5 text-sm font-medium hover:bg-gray-800 transition cursor-pointer">
        + Add Game
      </button>

      <button
        (click)="toggleView('table')"
        class="px-3 py-2 rounded-lg border cursor-pointer"
        [class.bg-black]="viewMode === 'table'"
        [class.text-white]="viewMode === 'table'">
        üìã
      </button>

      <button
        (click)="toggleView('card')"
        class="px-3 py-2 rounded-lg border cursor-pointer"
        [class.bg-black]="viewMode === 'card'"
        [class.text-white]="viewMode === 'card'">
        üß©
      </button>

    </div>
  </div>


  <!-- ================= TABLE VIEW ================= -->
  <div *ngIf="viewMode === 'table'"
       class="animate-fade bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden">

    <table class="w-full text-sm text-gray-700">
      <thead class="bg-gray-50 text-xs uppercase text-gray-500">
        <tr>
          <th class="px-6 py-4">#</th>
          <th class="px-6 py-4 text-left">Title</th>
          <th class="px-6 py-4 text-left">Price</th>
          <th class="px-6 py-4 text-left">Platform</th>
          <th class="px-6 py-4 text-right">Actions</th>
        </tr>
      </thead>

      <tbody class="divide-y divide-gray-100">
        <tr *ngFor="let game of games; let i = index"
            class="hover:bg-gray-50">

          <td class="px-6 py-4 text-gray-400">{{ i + 1 }}</td>

          <td class="px-6 py-4 font-medium text-gray-900 flex items-center gap-3">
            <img *ngIf="game.imageUrl" [src]="game.imageUrl" class="h-10 w-10 rounded object-cover" />
            {{ game.title }}
          </td>

          <td class="px-6 py-4">
            ‚Ç±{{ game.price | number:'1.2-2' }}
          </td>

          <td class="px-6 py-4">{{ game.platform }}</td>

          <td class="px-6 py-4 text-right">
            <div class="inline-flex gap-3">
              <button (click)="editGame(game.id)" class="text-gray-400 hover:text-black cursor-pointer">‚úèÔ∏è</button>
              <button (click)="confirmDelete(game.id)" class="text-gray-400 hover:text-red-600 cursor-pointer">üóëÔ∏è</button>
            </div>
          </td>

        </tr>
      </tbody>
    </table>

    <div *ngIf="!games.length" class="py-16 text-center text-gray-500">
      No video games found.
    </div>

  </div>


  <!-- ================= CARD VIEW ================= -->
  <div *ngIf="viewMode === 'card'"
       class="animate-fade grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">

    <div *ngFor="let game of games"
         class="bg-white rounded-2xl shadow-md hover:shadow-xl transition-all overflow-hidden">

      <div class="h-48 bg-gray-100">
        <img *ngIf="game.imageUrl" [src]="game.imageUrl" class="w-full h-full object-cover" />
      </div>

      <div class="p-5">
        <h3 class="text-lg font-semibold text-gray-900">{{ game.title }}</h3>
        <p class="text-sm text-gray-500">{{ game.platform }}</p>
        <p class="mt-2 font-semibold text-gray-900">‚Ç±{{ game.price | number:'1.2-2' }}</p>

        <div class="mt-4 flex justify-between items-center">
          <button (click)="editGame(game.id)" class="text-sm text-blue-600 hover:underline">Edit</button>
          <button (click)="confirmDelete(game.id)" class="text-sm text-red-600 hover:underline">Delete</button>
        </div>
      </div>

    </div>

  </div>

</div>



<!-- ================= SKELETON LOADING TEMPLATE ================= -->
<ng-template #skeletonLoading>

  <!-- HEADER SKELETON -->
  <div class="max-w-7xl mx-auto px-8 pb-12">

    <div class="flex justify-between items-center mb-6">

      <app-skeleton-box width="200px" height="30px"></app-skeleton-box>

      <div class="flex items-center gap-3">
        <app-skeleton-box width="250px" height="35px"></app-skeleton-box>
        <app-skeleton-box width="90px" height="35px" rounded="20px"></app-skeleton-box>
        <app-skeleton-box width="40px" height="35px" rounded="10px"></app-skeleton-box>
        <app-skeleton-box width="40px" height="35px" rounded="10px"></app-skeleton-box>
      </div>

    </div>

    <!-- TABLE SKELETON -->
    <div class="bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden">

      <div class="p-6 space-y-4">

        <div *ngFor="let i of [1,2,3,4,5]">
          <div class="grid grid-cols-5 gap-6 items-center">

            <app-skeleton-box width="40px" height="20px"></app-skeleton-box>
            <app-skeleton-box width="120px" height="20px"></app-skeleton-box>
            <app-skeleton-box width="80px" height="20px"></app-skeleton-box>
            <app-skeleton-box width="100px" height="20px"></app-skeleton-box>
            <app-skeleton-box width="80px" height="20px"></app-skeleton-box>

          </div>
        </div>

      </div>

    </div>

  </div>

</ng-template>
