<aside
  class="fixed left-0 top-0 h-full z-40
         backdrop-blur-xl bg-white/70
         border-r border-gray-200 shadow-xl
         flex flex-col
         transition-[width] duration-300 ease-[cubic-bezier(.22,1,.36,1)]"
  [class.w-64]="!isMinimized"
  [class.w-20]="isMinimized">

  <!-- HEADER -->
  <div
    class="flex items-center h-16 px-4 border-b border-gray-200"
    [class.justify-center]="isMinimized">

    <!-- LOGO -->
    <div
      class="w-9 h-9 
             border border-purple-500 rounded-full
             flex items-center justify-center shadow-md ml-5">
      <svg 
        class="w-7 h-7 text-purple-600 flex-shrink-0"
        viewBox="0 0 24 24" 
        fill="none" 
        stroke="currentColor" 
        stroke-width="2">
        <path stroke-linecap="round" stroke-linejoin="round"
          d="M6 12h2m4-4v2m0 4v2m4-4h2M7 17l2-2h6l2 2M5 7h14a2 2 0 0 1 2 2v6a5 5 0 0 1-5 5H8a5 5 0 0 1-5-5V9a2 2 0 0 1 2-2z"/>
      </svg>
    </div>

    <!-- TITLE -->
    <span
      class="ml-3 font-semibold text-gray-900 truncate
             transition-opacity duration-200"
      [class.opacity-0]="isMinimized">
      Video Games
    </span>

    <!-- TOGGLE -->
    <button
      (click)="toggleSidebar()"
      class="ml-auto p-2 rounded-lg hover:bg-black/5 transition"
      [class.ml-0]="isMinimized">

      <svg
        class="w-5 h-5 text-gray-600 transition-transform duration-300"
        [class.rotate-180]="isMinimized"
        fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-width="2" d="M15 19l-7-7 7-7"/>
      </svg>
    </button>
  </div>

  <!-- NAV -->
  <nav class="flex flex-col gap-1 p-3">

    <!-- DASHBOARD -->
    <a
      routerLink="/dashboard"
      routerLinkActive="bg-purple-500/10 text-purple-700"
      [routerLinkActiveOptions]="{ exact: true }"
      class="flex items-center px-3 py-3 rounded-xl
             font-medium text-gray-700 hover:bg-purple-500/10 transition"
      [class.justify-center]="isMinimized"
      [class.gap-3]="!isMinimized">

      <svg class="w-5 h-5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-width="2" d="M3 13h8V3H3v10zm10 8h8V11h-8v10z"/>
      </svg>

      <span [class.hidden]="isMinimized">Dashboard</span>
    </a>

    <!-- ðŸ’¬ CONVERSATIONS (NEW) -->
    <a
      routerLink="/admin/conversations"
      routerLinkActive="bg-purple-500/10 text-purple-700"
      class="relative flex items-center px-3 py-3 rounded-xl
             font-medium text-gray-700 hover:bg-purple-500/10 transition"
      [class.justify-center]="isMinimized"
      [class.gap-3]="!isMinimized">

      <!-- ICON -->
      <svg class="w-5 h-5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
          d="M8 10h8m-8 4h5
             M21 12c0 4.418-4.03 8-9 8
             a9.77 9.77 0 01-4-.8L3 20l1.5-3.8
             A7.94 7.94 0 013 12
             c0-4.418 4.03-8 9-8s9 3.582 9 8z"/>
      </svg>

      <span [class.hidden]="isMinimized">Conversations</span>

      <!-- UNREAD BADGE -->
      <span
        *ngIf="unreadCount > 0"
        class="absolute right-3 top-1/2 -translate-y-1/2
               min-w-[18px] h-[18px] px-1
               rounded-full bg-purple-600 text-white
               text-[10px] font-semibold
               flex items-center justify-center"
        [class.right-2]="isMinimized">
        {{ unreadCount }}
      </span>
    </a>

    <!-- GAMES -->
    <a
      routerLink="/videogames"
      routerLinkActive="bg-purple-500/10 text-purple-700"
      class="flex items-center px-3 py-3 rounded-xl
             font-medium text-gray-700 hover:bg-purple-500/10 transition"
      [class.justify-center]="isMinimized"
      [class.gap-3]="!isMinimized">

      <svg class="w-5 h-5 flex-shrink-0"
           fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-width="2"
              d="M7 12h4M9 10v4M15 11h.01M17 13h.01"/>
        <rect x="3" y="7" width="18" height="10" rx="3"/>
      </svg>

      <span [class.hidden]="isMinimized">Games</span>
    </a>

    <!-- ADD GAME -->
    <a
      routerLink="/videogames/new"
      routerLinkActive="bg-purple-500/10 text-purple-700"
      class="flex items-center px-3 py-3 rounded-xl
             font-medium text-gray-700 hover:bg-purple-500/10 transition"
      [class.justify-center]="isMinimized"
      [class.gap-3]="!isMinimized">

      <svg class="w-5 h-5 flex-shrink-0"
           fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-width="2" d="M12 5v14M5 12h14"/>
      </svg>

      <span [class.hidden]="isMinimized">Add Game</span>
    </a>

    <!-- ORDERS -->
    <a
      routerLink="/admin/orders"
      routerLinkActive="bg-purple-500/10 text-purple-700"
      class="flex items-center px-3 py-3 rounded-xl
             font-medium text-gray-700 hover:bg-purple-500/10 transition"
      [class.justify-center]="isMinimized"
      [class.gap-3]="!isMinimized">

      <svg class="w-6 h-6 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-width="2" d="M7 8h10M7 12h6M7 16h10"/>
      </svg>

      <span [class.hidden]="isMinimized">Orders</span>
    </a>

  </nav>

  <!-- USER PANEL (UNCHANGED) -->
  <div
    *ngIf="user$ | async as user"
    class="mt-auto p-4 border-t border-gray-200 relative">

    <button
      (click)="toggleDropdown()"
      class="flex items-center w-full p-3 rounded-2xl
             hover:bg-black/5 transition"
      [class.justify-center]="isMinimized">

      <div
        class="w-10 h-10 rounded-full
               bg-gradient-to-br from-purple-500 to-indigo-500
               flex items-center justify-center
               text-white font-semibold shadow">
        {{ (user.username || user.email || 'U')[0] | uppercase }}
      </div>

      <div class="ml-3 flex-1 truncate" [class.hidden]="isMinimized">
        <div class="font-medium text-gray-900 truncate">
          {{ user.username }}
        </div>
        <div class="text-xs text-gray-500 truncate">
          {{ user.email }}
        </div>
      </div>

      <svg *ngIf="!isMinimized"
           class="w-4 h-4 text-gray-500 transition-transform duration-200"
           [class.rotate-180]="isDropdownOpen"
           fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-width="2" d="M6 9l6 6 6-6"/>
      </svg>
    </button>

    <!-- DROPDOWN -->
    <div
      *ngIf="isDropdownOpen && !isMinimized"
      class="absolute left-4 right-4 bottom-20
             rounded-2xl bg-white/80 backdrop-blur-xl
             border border-gray-200 shadow-xl overflow-hidden">

      <a routerLink="/profile" (click)="closeDropdown()"
         class="flex items-center gap-3 px-4 py-3 text-sm
                text-gray-700 hover:bg-purple-500/10 transition">
        Profile
      </a>

      <a routerLink="/settings/password"
         class="flex items-center gap-3 px-4 py-3 text-sm
                text-gray-700 hover:bg-purple-500/10 transition">
        Change Password
      </a>

      <button (click)="logout()"
        class="flex items-center gap-3 w-full px-4 py-3 text-sm
               text-red-600 hover:bg-red-500/10 transition">
        Logout
      </button>
    </div>
  </div>
</aside>
